<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Free Academy - Dashboard</title>

<link href="/assets/css/bootstrap.min.css" rel="stylesheet">
<link href="/assets/css/dashboard.css" rel="stylesheet">
<link href="/assets/css/newsfeed.css" rel="stylesheet">

<script src="/assets/js/libs/lumino.glyphs.js"></script>
</head>
<body>
   <include filename=dashboard/include/header>

		<div class="row">
			<div class="col-lg-12">
				<h1 class="page-header">Backup</h1>
			</div>
		</div><!--/.row-->

		<div class="row">
        <!-- hien thi tin tuc-->
        <div class="col-md-12">
          <div class="panel panel-default">
            <form class="newposts" method="post" action="backup">
              <input type="hidden" name="hash" value="<eng data=hash>">
              <div class="form-group">
                <h4 style="display: inline">Collection: </h4>
                <select name="type">
                  <option value="0">All</option>
                  <option value="1">Newsfeed</option>
                  <option value="2">Document</option>
                  <option value="3">Question</option>
                </select>
                <h4 style="margin-left: 8px; display: inline">File Type: </h4>
                <select name="mtype">
                  <option value="0">json</option>
                  <option value="1">csv</option>
                </select>
                <input type="submit" class="btn btn-primary" value="Backup">
              </div>
              <div id="file"></div>
              <div class="form-group">
                <label for="fd_content">Result:</label>
                <textarea class="form-control" rows="15" name="content" id="fd_content"></textarea>
              </div>
            </form>
          </div>

       </div>
		</div><!--/.row-->
	</div>	<!--/.main-->

	<script src="/assets/js/libs/jquery.min.js"></script>
	<script src="/assets/js/libs/bootstrap.min.js"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      const hash = '<eng data=hash>';

      let render = function(datas) {
        console.log(datas);
        $('#fd_content').val(JSON.stringify(datas));
      }

      $('form').submit(function(e) {
        let type = $('[name="type"]').val();
        let mtype = $('[name="mtype"]').val();

        $.post('/dashboard/backup',
          {
            type,
            mtype,
            hash
          },
          function(datas, status){
              render(datas);
          }
        );

        e.preventDefault();
      });
    });
  </script>
</body>
</html>
